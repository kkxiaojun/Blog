# 图解HTTP
## Web网络基础
### TCP/IP协议族分层： 应用层、传输层、网络层、数据链路层
image-http
* 应用层：决定了向用户提供应用服务时通信的活动（发送HTTP报文）。FTP/DNS/HTTP
* 传输层：传输层对上层应用，网络连接中的计算机之间的数据传输。有TCP（transmission Control Protocol，传输控制协议）和 UDP(User Data Protocol，用户数据报协议) 
* 网络层（网络互联层）：网络层用来处理在网络上流动的数据包。IP
* 链路层（数据链路层，网络接口层）：用来处理连接网络的硬件部分。操作系统、设备驱动、NIC(网络设配器，网卡)，光纤
image-http1

### IP协议：IP地址和Mac地址
* IP地址指明了节点被分配到的地址，Mac地址是指网卡所属的固定地址

**TCP协议：提供可靠的字节流服务。将大块数据分割成以报文段为单位的数据包进行管理**

为了准确无误地将数据送达目标，TCP协议采用了三次握手策略：发送端首先发送一个带SYN标志的数据包给对方。接收端收到后，回传一个带有SYN/ACK标志的数据包以示传达确认信息。最后，发送端再回传一个带ACK标志的数据包，代表“握手”结束
### 各种协议与HTTP协议的关系
image-http-tcp **DNS(Domain Name System)**提供域名到IP地址之间的解析服务

## http协议
1. 用于客户端与服务端之间的通信。（发送请求报文）
2. 不保存状态的协议（为了实现期望的保持状态的功能，引入cookie技术）

### 请求报文 
由请求方法、请求URL、协议版本、可选的请求首部字段和内容实体构成
### http方法
|方法|说明|
|----|----|
|GET|获取资源|
|POST|传输实体主体|
|PUT|传输文件|
|DELETE|删除文件|
|HEAD|获取报文首部|
|OPTIONS|询问支持的方法|
|CONNECT|要求用隧道协议连接代理|
|TRACE|追踪路径|

## HTTP报文内的HTTP信息
用于HTTP协议交互的信息称为报文。HTTP报文本身由多行数据构成的字符串文本。
1. 报文：报文首部和主体
2. 报文首部：请求行（uri/http），状态行(状态码)，首部字段，其它
## http状态码
**类别**
|状态码|类别|原因|
|---|---|---|
|1XX|Informational(信息性状态码)|接收的请求正在处理|
|2XX|Success|请求正常处理完毕|
|3XX|Redirectin|需要进行附加操以完成请求|
|4XX|Client Error(客户端错误)|服务器无法处理请求|
|5XX|Server Error|服务器请求出错|

**状态码详情**
* 100
> 表示目前为止一切正常, 客户端应该继续请求, 如果已完成请求则忽略

* 200 表明请求已经成功. 默认情况下成功的请求将会被缓存。不同请求方式对于请求成功的意义如下:
    *  GET: 已经取得资源，并将资源添加到响应中的消息体.
    * HEAD: 作为消息体的头部信息.
    * POST: 消息体中描述此次请求的结果.
    * TRACE: 响应的消息体包含服务器接收到的请求信息.
* 201 是一个代表成功的应答状态码，表示请求已经被成功处理，并且创建了新的资源。新的资源在应答返回之前已经被创建。同时新增的资源会在应答消息体中返回，其地址或者是原始请求的路径，或者是 Location 首部的值。


* 300 是一个用来表示重定向的响应状态码，表示该请求拥有多种可能的响应。用户代理或者用户自身应该从中选择一个。
* 301 永久重定向 说明请求的资源已经被移动到了由 Location 头部指定的url上，是固定的不会再改变。搜索引擎会根据该响应修正。

* 302 重定向状态码表明请求的资源被暂时的移动到了由Location 头部指定的 URL 上。浏览器会重定向到这个URL， 但是搜索引擎不会对该资源的链接进行更新
* 303 重定向状态码，通常作为 PUT 或 POST 操作的返回结果，它表示重定向链接指向的不是新上传的资源，而是另外一个页面，比如消息确认页面或上传进度页面。而请求重定向页面的方法要总是使用 GET。

* 304 改变说明无需再次传输请求的内容，也就是说可以使用缓存的内容。这通常是在一些安全的方法（safe），例如GET 或HEAD 或在请求中附带了头部信息
* 307 临时重定向）是表示重定向的响应状态码，说明请求的资源暂时地被移动到  Location 首部所指向的 URL 上。
> 状态码 307 与 302 之间的唯一区别在于，当发送重定向请求的时候，307 状态码可以确保请求方法和消息主体不会发生变化。当响应状态码为 302 的时候，一些旧有的用户代理会错误地将请求方法转换为 GET：使用非 GET 请求方法而返回 302 状态码，Web 应用的运行状况是不可预测的；而返回 307 状态码时则是可预测的。对于 GET 请求来说，两种情况没有区别。

* 308 永久重定向）是表示重定向的响应状态码，说明请求的资源已经被永久的移动到了由 Location 首部指定的 URL 上。
> 在重定向过程中，请求方法和消息主体不会发生改变，然而在返回 301 状态码的情况下，请求方法有时候会被客户端错误地修改为 GET 方法。

* 401 代表客户端错误，指的是由于缺乏目标资源要求的身份验证凭证，发送的请求未得到满足。
* 403 代表客户端错误，指的是服务器端有能力处理该请求，但是拒绝授权访问。
* 404 代表客户端错误，指的是服务器端无法找到所请求的资源。由于它的频繁出现，这个状态码估计是最著名的一个了。返回该响应的链接通常称为坏链（broken link）或死链（dead link），它们会导向链接出错处理(link rot)页面。
* 405 表明服务器禁止了使用当前 HTTP 方法的请求。需要注意的是，GET 与 HEAD 两个方法不得被禁止，当然也不得返回状态码 405。
* 500 是表示服务器端错误的响应状态码，意味着所请求的服务器遇到意外的情况并阻止其执行请求。
* 503 是一种HTTP协议的服务器端错误状态代码，它表示服务器尚未处于可以接受请求的状态。常造成这种情况的原因是由于服务器停机维护或者已超载。

## Http报文
### 报文首部
**通用首部字段**
### cookies首部字段
|属性|说明|
|----|----|
|NAME=VALUE|名称和值|
|expires=DATE|Cookie有效期（不指定时，到浏览器关闭为止）|
|path=PATH|将服务器上的文件目录作为Cookie的适用对象|
|domain|作为cookie适用对象的域名|
|secure|尽在HTTPS安全通信才发送cookie|
|httpOnly|加以限制，使Cookie不能被JavaScript脚本访问|

### 其它首部字段
|属性|说明|
|----|----|
|X-Frame-Options|用于控制网站内容在其它网站的Frame标签内的显示问题（可指定字段值：DENY,SAMEORINGIN）|
|X-XSS-Protection|针对跨站脚本攻击XSS的一种对策（0：将XSS过路设置成无效。1：有效）|
|DNT|Do Not Track,拒绝个人信息被收集（0：同意被追踪，1：拒绝被追踪）|

## web安全的https
https是在http上加入加密处理和认证的机制，Http通信接口部分用SSL（Secure Sockets Layer 安全套接层）和TLS（Transport Layer Security）协议代替。

## 扩展
### websocket
web浏览器与web服务器之间的全双工通信标准
优点：
1. 服务端能主动推送
2. 只要建立连接，能一直保持连接状态

原理： http连接建立之后，要完成“握手”，需要用到http的Upgrade首部字段。
image-http-websoket

### worker
# 计算机通识
